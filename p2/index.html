<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>Thai P2 Classroom System</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --main: #ff8e3c; --bg: #eff0f3; --dark: #0d0d0d; }
        body { margin: 0; font-family: 'Sarabun', sans-serif; background: var(--bg); overflow: hidden; }
        
        /* Layout */
        #sidebar { position: fixed; left: 0; width: 280px; height: 100vh; background: #fffffe; border-right: 2px solid #ddd; z-index: 10; padding: 20px; box-sizing: border-box; }
        #main-stage { margin-left: 280px; height: 100vh; position: relative; padding: 30px; display: flex; flex-direction: column; align-items: center; }
        
        /* Tools - Shared Style */
        .window { position: absolute; background: white; border: 3px solid var(--dark); border-radius: 12px; box-shadow: 8px 8px 0 rgba(0,0,0,0.1); padding: 15px; cursor: move; z-index: 100; min-width: 150px; }
        .window-header { cursor: move; border-bottom: 2px solid #eee; margin-bottom: 10px; font-weight: bold; display: flex; justify-content: space-between; }
        
        /* 1. Timer Tool */
        #timer-box { top: 20px; right: 20px; width: 200px; resize: both; overflow: hidden; }
        #time-display { font-size: 3rem; text-align: center; font-weight: bold; color: #ff5252; margin: 10px 0; }
        .progress-bar { height: 8px; background: #eee; border-radius: 4px; overflow: hidden; }
        #progress-fill { height: 100%; background: #ff5252; width: 100%; transition: width 1s linear; }

        /* 2. Randomizer Tool */
        #random-box { bottom: 20px; right: 20px; width: 220px; text-align: center; }
        #lucky-num { font-size: 4rem; background: #232946; color: #b8c1ec; border-radius: 8px; margin: 10px 0; padding: 10px; }

        /* 3. Whiteboard */
        #board-canvas { position: fixed; top: 0; left: 0; pointer-events: none; z-index: 50; }
        .canvas-active { pointer-events: auto !important; }
        #board-controls { position: fixed; top: 15px; left: 300px; z-index: 60; background: white; padding: 10px; border-radius: 30px; border: 2px solid #333; display: flex; gap: 10px; align-items: center; }

        /* Lesson Styles */
        .card { background: white; padding: 30px; border-radius: 20px; width: 80%; max-width: 800px; border: 3px solid #333; text-align: center; }
        button { cursor: pointer; padding: 8px 15px; border-radius: 8px; border: 2px solid #333; background: #ffd166; font-weight: bold; }
        button:hover { background: #ffbd05; }
        .lesson-list button { display: block; width: 100%; margin-bottom: 10px; text-align: left; background: #e3f2fd; }
    </style>
</head>
<body>

<div id="board-controls">
    <span>üñåÔ∏è ‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤:</span>
    <input type="color" id="penColor" value="#2d3436">
    <input type="range" id="penSize" min="2" max="20" value="5">
    <button onclick="toggleDraw()" id="btnDraw">‡πÇ‡∏´‡∏°‡∏î: ‡∏î‡∏π‡πÇ‡∏à‡∏ó‡∏¢‡πå</button>
    <button onclick="clearCanvas()" style="background:#ffadad">‡∏•‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠</button>
</div>

<div id="sidebar">
    <h2>üìñ ‡∏†‡∏≤‡∏©‡∏≤‡∏û‡∏≤‡∏ó‡∏µ ‡∏õ.2</h2>
    <div class="lesson-list">
        <button onclick="setLesson(1)">‡∏´‡∏ô‡πâ‡∏≤ 22: ‡∏™‡∏£‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢ (‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô, ‡πÄ‡∏ï‡∏µ‡πâ‡∏¢)</button>
        <button onclick="setLesson(2)">‡∏´‡∏ô‡πâ‡∏≤ 37: ‡∏Ñ‡∏≥‡∏Ñ‡∏ß‡∏ö‡∏Å‡∏•‡πâ‡∏≥ (‡∏û‡∏£‡∏¥‡∏Å, ‡∏õ‡∏•‡∏≤)</button>
        <button onclick="setLesson(3)">‡∏´‡∏ô‡πâ‡∏≤ 65: ‡∏Ñ‡∏≥‡∏¢‡∏≤‡∏Å (‡πÑ‡∏≠‡∏®‡∏Å‡∏£‡∏µ‡∏°, ‡∏°‡∏≤‡∏£‡∏¢‡∏≤‡∏ó)</button>
        <button onclick="setLesson(4)">‡∏´‡∏ô‡πâ‡∏≤ 87: ‡πÇ‡∏•‡∏Å‡∏£‡πâ‡∏≠‡∏ô (‡∏õ‡∏•‡∏π‡∏Å‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ)</button>
    </div>
</div>

<div id="main-stage">
    <div class="card">
        <h1 id="lesson-name">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ö‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°</h1>
        <div id="content-body" style="font-size: 2.5rem; color: #2d3436;">---</div>
    </div>
</div>

<div id="timer-box" class="window">
    <div class="window-header">‚è±Ô∏è ‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤ <span>::</span></div>
    <div class="progress-bar"><div id="progress-fill"></div></div>
    <div id="time-display">00:00</div>
    <div style="display:flex; gap:5px;">
        <input type="number" id="t-input" value="60" style="width:60px">
        <button onclick="startTimer()">GO!</button>
        <button onclick="resetTimer()">R</button>
    </div>
</div>

<div id="random-box" class="window">
    <div class="window-header">üé≤ ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà <span>::</span></div>
    <div id="lucky-num">??</div>
    <div style="font-size:0.8rem">
        ‡∏ä‡πà‡∏ß‡∏á: <input type="number" id="r-min" value="1" style="width:40px"> - 
        <input type="number" id="r-max" value="40" style="width:40px"> <br>
        ‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡∏∏‡πà‡∏°: <input type="number" id="r-sec" value="3" style="width:40px"> ‡∏ß‡∏¥
        <button onclick="runRandom()" style="margin-top:10px; width:100%">START SPIN</button>
    </div>
</div>

<canvas id="board-canvas"></canvas>

<script>
    // --- Whiteboard System ---
    const canvas = document.getElementById('board-canvas');
    const ctx = canvas.getContext('2d');
    let isDrawing = false;
    let canDraw = false;

    function initCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    window.onresize = initCanvas;
    initCanvas();

    function toggleDraw() {
        canDraw = !canDraw;
        canvas.classList.toggle('canvas-active', canDraw);
        document.getElementById('btnDraw').innerText = canDraw ? "‡πÇ‡∏´‡∏°‡∏î: ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô" : "‡πÇ‡∏´‡∏°‡∏î: ‡∏î‡∏π‡πÇ‡∏à‡∏ó‡∏¢‡πå";
        document.getElementById('btnDraw').style.background = canDraw ? "#9ef01a" : "#ffd166";
    }

    canvas.addEventListener('mousedown', (e) => { if(!canDraw) return; isDrawing = true; draw(e); });
    canvas.addEventListener('mousemove', draw);
    window.addEventListener('mouseup', () => { isDrawing = false; ctx.beginPath(); });

    function draw(e) {
        if (!isDrawing) return;
        ctx.lineWidth = document.getElementById('penSize').value;
        ctx.lineCap = 'round';
        ctx.strokeStyle = document.getElementById('penColor').value;
        ctx.lineTo(e.clientX, e.clientY);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(e.clientX, e.clientY);
    }
    function clearCanvas() { ctx.clearRect(0,0,canvas.width,canvas.height); }

    // --- Timer System ---
    let t_interval;
    function startTimer() {
        clearInterval(t_interval);
        let sec = parseInt(document.getElementById('t-input').value);
        let total = sec;
        const display = document.getElementById('time-display');
        const fill = document.getElementById('progress-fill');
        
        t_interval = setInterval(() => {
            sec--;
            let m = Math.floor(sec/60);
            let s = sec%60;
            display.innerText = `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
            fill.style.width = (sec/total)*100 + "%";
            if(sec <= 0) { clearInterval(t_interval); alert("TIMEOUT!"); }
        }, 1000);
    }
    function resetTimer() { clearInterval(t_interval); document.getElementById('time-display').innerText="00:00"; }

    // --- Randomizer System (Sound + Animation) ---
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playBeep() {
        let osc = audioCtx.createOscillator();
        let gain = audioCtx.createGain();
        osc.connect(gain); gain.connect(audioCtx.destination);
        osc.frequency.value = 440; gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.1);
        osc.start(); osc.stop(audioCtx.currentTime + 0.1);
    }

    function runRandom() {
        const min = parseInt(document.getElementById('r-min').value);
        const max = parseInt(document.getElementById('r-max').value);
        const duration = parseInt(document.getElementById('r-sec').value) * 1000;
        const display = document.getElementById('lucky-num');
        let startTime = Date.now();
        
        let spin = setInterval(() => {
            display.innerText = Math.floor(Math.random() * (max - min + 1)) + min;
            playBeep();
            if (Date.now() - startTime >= duration) {
                clearInterval(spin);
                display.style.color = "red";
                setTimeout(()=> display.style.color = "#b8c1ec", 2000);
            }
        }, 80);
    }

    // --- Lesson Content Loader (From PDF Data) ---
    const lessonData = {
        1: { name: "‡∏™‡∏£‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢ (‡∏´‡∏ô‡πâ‡∏≤ 22)", body: "‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡∏≥: ‡∏Å_ _ ‡∏ô , ‡∏™_ _ ‡πÉ‡∏à , ‡∏ï_ _ _" }, // [cite: 16, 17, 19]
        2: { name: "‡∏Ñ‡∏≥‡∏Ñ‡∏ß‡∏ö‡∏Å‡∏•‡πâ‡∏≥ (‡∏´‡∏ô‡πâ‡∏≤ 37)", body: "‡∏£: ‡∏û‡∏£‡∏¥‡∏Å, ‡∏û‡∏£‡∏∞ / ‡∏•: ‡∏õ‡∏•‡∏≤, ‡∏Å‡∏•‡∏≠‡∏á" }, // [cite: 89, 90, 92, 94]
        3: { name: "‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å (‡∏´‡∏ô‡πâ‡∏≤ 65)", body: "‡πÑ‡∏≠‡∏®‡∏Å‡∏£‡∏µ‡∏° üçß ‡∏°‡∏≤‡∏£‡∏¢‡∏≤‡∏ó üôè ‡πÄ‡∏≠‡∏£‡πá‡∏î‡∏≠‡∏£‡πà‡∏≠‡∏¢ üòã" }, // [cite: 121, 122, 124]
        4: { name: "‡∏•‡∏î‡πÇ‡∏•‡∏Å‡∏£‡πâ‡∏≠‡∏ô (‡∏´‡∏ô‡πâ‡∏≤ 87)", body: "‚úÖ ‡∏õ‡∏•‡∏π‡∏Å‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ ‚ùå ‡πÄ‡∏ú‡∏≤‡∏Ç‡∏¢‡∏∞" } // 
    };

    function setLesson(id) {
        document.getElementById('lesson-name').innerText = lessonData[id].name;
        document.getElementById('content-body').innerHTML = lessonData[id].body;
    }

    // Draggable Functionality
    document.querySelectorAll('.window').forEach(win => {
        let isDragging = false, offset = [0,0];
        win.onmousedown = (e) => {
            isDragging = true;
            offset = [win.offsetLeft - e.clientX, win.offsetTop - e.clientY];
        };
        document.onmousemove = (e) => {
            if(!isDragging) return;
            win.style.left = (e.clientX + offset[0]) + 'px';
            win.style.top = (e.clientY + offset[1]) + 'px';
        };
        document.onmouseup = () => isDragging = false;
    });
</script>
</body>
</html>
