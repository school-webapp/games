<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loanword Battle Royale - ‡πÄ‡∏Å‡∏°‡∏™‡∏°‡∏£‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏≥‡∏¢‡∏∑‡∏°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Kanit', sans-serif; background-color: #0f172a; overflow: hidden; }
        .neon-text { text-shadow: 0 0 10px #3b82f6; }
        
        /* Drawing Canvas Styles - ‡πÅ‡∏ú‡πà‡∏ô‡πÉ‡∏™‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏≤‡∏î */
        #drawing-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            z-index: 100; /* ‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏•‡∏±‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏ï‡πà‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÄ‡∏Å‡∏° */
        }
        #drawing-canvas.active {
            pointer-events: auto;
            cursor: crosshair;
        }

        /* Tool active indicator */
        .tool-active {
            box-shadow: 0 0 0 3px white, 0 0 15px rgba(255,255,255,0.5);
            transform: scale(1.15);
        }

        /* Pop-in Animation */
        @keyframes pop-in {
            0% { transform: scale(0.5); opacity: 0; }
            80% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }
        .animate-pop { animation: pop-in 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        
        .timer-urgent { animation: pulse-red 0.5s infinite; }
        @keyframes pulse-red { 0%, 100% { background-color: #ef4444; } 50% { background-color: #7f1d1d; } }
    </style>
</head>
<body class="text-white">

<!-- Drawing Canvas Overlay -->
<canvas id="drawing-canvas"></canvas>

<div id="app" class="min-h-screen p-4 flex flex-col relative">
    <!-- Header - ‡∏õ‡∏£‡∏±‡∏ö Z-index ‡πÉ‡∏´‡πâ‡∏™‡∏π‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÄ‡∏™‡∏°‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÑ‡∏î‡πâ -->
    <header class="flex justify-between items-center bg-slate-800 p-4 rounded-2xl shadow-2xl border border-slate-700 mb-6 relative z-[200]">
        <div class="flex items-center gap-4">
            <div class="bg-blue-600 p-3 rounded-xl shadow-lg">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg>
            </div>
            <div>
                <h1 class="text-2xl font-bold neon-text">‡∏™‡∏°‡∏£‡∏†‡∏π‡∏°‡∏¥‡∏Ñ‡∏≥‡∏¢‡∏∑‡∏°</h1>
                <p class="text-xs text-slate-400 font-light">‡∏†‡∏≤‡∏©‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÉ‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ (Fix Drawing Tools)</p>
            </div>
        </div>
        
        <!-- Toolbar: ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏Ç & ‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏à‡∏≠ -->
        <div class="flex items-center gap-4 bg-slate-900/80 p-2 px-4 rounded-2xl border border-slate-600 shadow-inner">
            <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏∏‡πà‡∏°‡∏ó‡∏µ‡∏° -->
            <button onclick="drawRandomNumber()" class="bg-purple-600 hover:bg-purple-500 px-4 py-2 rounded-xl text-sm font-bold transition-all shadow-lg active:scale-95 flex items-center gap-2">
                üé≤ ‡∏™‡∏∏‡πà‡∏°‡∏ó‡∏µ‡∏°
            </button>

            <!-- ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ -->
            <div class="flex items-center gap-4 border-l border-slate-700 pl-4">
                <button id="btn-draw-toggle" onclick="toggleDrawing()" class="bg-slate-700 hover:bg-slate-600 p-2 px-3 rounded-xl transition-all text-xl" title="‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î ‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤">
                    ‚úèÔ∏è
                </button>
                
                <div id="draw-tools" class="hidden flex items-center gap-3">
                    <div class="flex gap-2 bg-slate-800 p-1.5 rounded-full border border-slate-700">
                        <button onclick="setBrushColor('#ef4444')" class="w-7 h-7 rounded-full bg-red-500 border border-white/20 transition-all hover:scale-110" id="color-red"></button>
                        <button onclick="setBrushColor('#3b82f6')" class="w-7 h-7 rounded-full bg-blue-500 border border-white/20 transition-all hover:scale-110" id="color-blue"></button>
                        <button onclick="setBrushColor('#f59e0b')" class="w-7 h-7 rounded-full bg-yellow-500 border border-white/20 transition-all hover:scale-110" id="color-yellow"></button>
                        <button onclick="setBrushColor('#ffffff')" class="w-7 h-7 rounded-full bg-white border border-slate-400 transition-all hover:scale-110 tool-active" id="color-white"></button>
                    </div>
                    <button onclick="clearCanvas()" class="bg-red-600 hover:bg-red-500 px-4 py-1.5 rounded-xl text-xs uppercase font-black shadow-lg transition-all active:scale-95">‡∏•‡πâ‡∏≤‡∏á‡∏à‡∏≠</button>
                </div>
            </div>
        </div>

        <div id="game-timer" class="text-4xl font-mono bg-slate-950 px-6 py-2 rounded-full border border-blue-500 text-blue-400 shadow-inner">60:00</div>

        <div class="flex gap-2">
            <button onclick="setupTeams()" class="bg-slate-700 hover:bg-slate-600 px-4 py-2 rounded-lg text-sm font-bold transition">‡∏ó‡∏µ‡∏°</button>
            <button onclick="resetGame()" class="bg-red-900/50 hover:bg-red-800 px-4 py-2 rounded-lg text-sm text-red-300">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
        </div>
    </header>

    <!-- Scoreboard -->
    <div id="scoreboard" class="grid grid-cols-4 gap-4 mb-6 relative z-10"></div>

    <!-- Main Game Board -->
    <main id="game-board" class="flex-grow grid grid-cols-4 gap-4 relative z-10"></main>
</div>

<!-- Question Modal -->
<div id="modal" class="fixed inset-0 bg-slate-950/90 hidden flex items-center justify-center p-6 z-[150] backdrop-blur-sm">
    <div class="bg-slate-900 w-full max-w-4xl rounded-3xl border-2 border-blue-500 p-8 shadow-2xl relative overflow-hidden animate-pop">
        <div id="modal-timer" class="absolute top-0 left-0 h-2 bg-blue-500 transition-all duration-1000" style="width: 100%;"></div>
        <div class="flex justify-between items-center mb-8">
            <span id="modal-category" class="bg-blue-600 px-6 py-2 rounded-full text-sm font-bold uppercase tracking-widest text-white shadow-lg">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</span>
            <span id="modal-points" class="text-4xl font-black text-yellow-400 drop-shadow-lg">500</span>
        </div>
        <div class="text-center py-12">
            <h2 id="modal-question" class="text-3xl md:text-5xl font-bold leading-tight mb-10 text-slate-100"></h2>
            <div id="modal-answer" class="hidden text-3xl text-emerald-400 font-bold bg-emerald-950/50 p-8 rounded-3xl border border-emerald-500/30 mb-10 shadow-inner">
                ‡πÄ‡∏â‡∏•‡∏¢: <span id="answer-text"></span>
            </div>
        </div>
        <div class="flex flex-wrap justify-center gap-6">
            <button id="btn-show-answer" onclick="showAnswer()" class="bg-yellow-500 hover:bg-yellow-400 text-slate-950 font-black px-12 py-5 rounded-2xl shadow-xl transition-all transform active:scale-95 text-xl uppercase">‡∏î‡∏π‡πÄ‡∏â‡∏•‡∏¢</button>
            <div id="scoring-controls" class="hidden flex gap-4"></div>
            <button onclick="closeModal()" class="bg-slate-800 hover:bg-slate-700 font-bold px-10 py-5 rounded-2xl border border-slate-600 transition-all text-lg">‡∏õ‡∏¥‡∏î</button>
        </div>
    </div>
</div>

<!-- Random Result Modal (‡∏õ‡πä‡∏≠‡∏õ‡∏≠‡∏±‡∏õ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏Ç‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà) -->
<div id="random-modal" class="fixed inset-0 bg-slate-950/95 hidden flex items-center justify-center z-[300] p-6 backdrop-blur-md">
    <div class="bg-slate-900 border-4 border-purple-500 p-16 rounded-[60px] text-center shadow-[0_0_150px_rgba(168,85,247,0.6)] animate-pop max-w-md w-full relative overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-b from-purple-600/10 to-transparent pointer-events-none"></div>
        <p class="text-purple-400 font-black uppercase tracking-[0.4em] mb-6 text-xl">‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà‡πÇ‡∏ä‡∏Ñ‡∏î‡∏µ‡∏Ñ‡∏∑‡∏≠</p>
        <div id="random-number-big" class="text-[18rem] font-black leading-none text-white drop-shadow-[0_0_40px_rgba(168,85,247,1)] mb-10 select-none">?</div>
        <button onclick="closeRandomModal()" class="w-full bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 py-6 rounded-3xl font-black text-2xl transition-all active:scale-95 shadow-2xl border-b-4 border-indigo-800">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°!</button>
    </div>
</div>

<script>
    // --- SOUND ENGINE ---
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playSound(freq, type, duration, vol = 0.1) {
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = type;
        osc.frequency.setValueAtTime(freq, audioCtx.currentTime);
        gain.gain.setValueAtTime(vol, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.start();
        osc.stop(audioCtx.currentTime + duration);
    }
    const sfx = {
        click: () => playSound(600, 'sine', 0.1),
        correct: () => { playSound(500, 'sine', 0.3); setTimeout(() => playSound(800, 'sine', 0.5), 100); },
        wrong: () => { playSound(150, 'sawtooth', 0.5, 0.2); },
        timer: () => playSound(1000, 'sine', 0.05, 0.05),
        open: () => playSound(400, 'square', 0.2, 0.05),
        win: () => { [440, 554, 659, 880].forEach((f, i) => setTimeout(() => playSound(f, 'sine', 0.6), i * 150)); },
        random: () => { [200, 300, 400, 500, 700, 900].forEach((f, i) => setTimeout(() => playSound(f, 'square', 0.1), i * 60)); }
    };

    // --- RANDOMIZER (NEW POP-UP) ---
    let numPool = [];
    function drawRandomNumber() {
        if (numPool.length === 0) {
            numPool = [1, 2, 3, 4];
            for (let i = numPool.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [numPool[i], numPool[j]] = [numPool[j], numPool[i]];
            }
        }
        const drawn = numPool.pop();
        sfx.random();
        document.getElementById('random-number-big').innerText = drawn;
        document.getElementById('random-modal').classList.remove('hidden');
    }
    function closeRandomModal() { sfx.click(); document.getElementById('random-modal').classList.add('hidden'); }

    // --- PRO WHITEBOARD LOGIC (FIXED) ---
    const canvas = document.getElementById('drawing-canvas');
    const ctx = canvas.getContext('2d');
    let isDrawingEnabled = false;
    let isDrawing = false;
    let brushColor = '#ffffff';

    function initCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        ctx.lineJoin = 'round';
        ctx.lineCap = 'round';
        ctx.lineWidth = 6;
        ctx.strokeStyle = brushColor;
    }

    function toggleDrawing() {
        isDrawingEnabled = !isDrawingEnabled;
        const btn = document.getElementById('btn-draw-toggle');
        const tools = document.getElementById('draw-tools');
        if (isDrawingEnabled) {
            canvas.classList.add('active');
            btn.classList.add('bg-blue-600', 'ring-2', 'ring-white');
            tools.classList.remove('hidden');
            setBrushColor(brushColor); 
        } else {
            canvas.classList.remove('active');
            btn.classList.remove('bg-blue-600', 'ring-2', 'ring-white');
            tools.classList.add('hidden');
            isDrawing = false;
        }
        sfx.click();
    }

    function setBrushColor(color) {
        brushColor = color;
        ctx.strokeStyle = color;
        ['red', 'blue', 'yellow', 'white'].forEach(c => {
            const el = document.getElementById('color-'+c);
            if(el) el.classList.remove('tool-active');
        });
        const colorName = color === '#ef4444' ? 'red' : color === '#3b82f6' ? 'blue' : color === '#f59e0b' ? 'yellow' : 'white';
        document.getElementById('color-'+colorName).classList.add('tool-active');
        sfx.click();
    }

    function clearCanvas() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        sfx.wrong();
    }

    // Event Listeners for Drawing
    canvas.addEventListener('mousedown', (e) => {
        if (!isDrawingEnabled) return;
        isDrawing = true;
        ctx.beginPath();
        ctx.moveTo(e.clientX, e.clientY);
        ctx.strokeStyle = brushColor; // ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏™‡∏µ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏™‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà
    });

    canvas.addEventListener('mousemove', (e) => {
        if (!isDrawing || !isDrawingEnabled) return;
        ctx.lineTo(e.clientX, e.clientY);
        ctx.stroke();
    });

    canvas.addEventListener('mouseup', () => { isDrawing = false; ctx.closePath(); });
    canvas.addEventListener('mouseleave', () => { isDrawing = false; });

    window.addEventListener('resize', initCanvas);
    initCanvas();

    // --- GAME DATA ---
    const gameData = [
        {
            category: "‡∏ö‡∏≤‡∏•‡∏µ-‡∏™‡∏±‡∏ô‡∏™‡∏Å‡∏§‡∏ï",
            questions: [
                { pts: 100, q: "‡∏û‡∏¢‡∏±‡∏ç‡∏ä‡∏ô‡∏∞‡∏ï‡∏±‡∏ß '‡∏¨' ‡πÉ‡∏ô‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ '‡∏Å‡∏µ‡∏¨‡∏≤' ‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡∏≠‡∏á‡∏†‡∏≤‡∏©‡∏≤‡πÉ‡∏î?", a: "‡∏†‡∏≤‡∏©‡∏≤‡∏ö‡∏≤‡∏•‡∏µ", used: false },
                { pts: 200, q: "‡∏™‡∏£‡∏∞ '‡πÑ‡∏≠' ‡πÅ‡∏•‡∏∞ '‡πÄ‡∏≠‡∏≤' ‡∏°‡∏±‡∏Å‡∏û‡∏ö‡πÉ‡∏ô‡∏Ñ‡∏≥‡∏¢‡∏∑‡∏°‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏©‡∏≤‡πÉ‡∏î?", a: "‡∏†‡∏≤‡∏©‡∏≤‡∏™‡∏±‡∏ô‡∏™‡∏Å‡∏§‡∏ï", used: false },
                { pts: 300, q: "‡∏ñ‡πâ‡∏≤‡∏†‡∏≤‡∏©‡∏≤‡∏ö‡∏≤‡∏•‡∏µ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ '‡∏≠‡∏¥‡∏ó‡∏ò‡∏¥' ‡∏†‡∏≤‡∏©‡∏≤‡∏™‡∏±‡∏ô‡∏™‡∏Å‡∏§‡∏ï‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£?", a: "‡∏§‡∏ó‡∏ò‡∏¥‡πå", used: false },
                { pts: 400, q: "‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ '‡∏†‡∏£‡∏£‡∏¢‡∏≤' ‡πÉ‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏™‡∏±‡∏ô‡∏™‡∏Å‡∏§‡∏ï ‡πÅ‡∏ú‡∏•‡∏á‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≥‡πÄ‡∏î‡∏¥‡∏°‡πÉ‡∏ô‡∏≠‡∏¥‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£?", a: "‡∏†‡∏≤‡∏£‡∏¢‡∏≤", used: false },
                { pts: 500, q: "‡∏û‡∏¢‡∏±‡∏ç‡∏ä‡∏ô‡∏∞ '‡∏®' ‡πÅ‡∏•‡∏∞ '‡∏©' ‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏¢‡∏±‡∏ç‡∏ä‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÉ‡∏î?", a: "‡∏†‡∏≤‡∏©‡∏≤‡∏™‡∏±‡∏ô‡∏™‡∏Å‡∏§‡∏ï", used: false }
            ]
        },
        {
            category: "‡∏†‡∏≤‡∏©‡∏≤‡πÄ‡∏Ç‡∏°‡∏£",
            questions: [
                { pts: 100, q: "‡∏Ñ‡∏≥‡∏£‡∏≤‡∏ä‡∏≤‡∏®‡∏±‡∏û‡∏ó‡πå '‡πÄ‡∏™‡∏ß‡∏¢' ‡πÅ‡∏•‡∏∞ '‡∏ö‡∏£‡∏£‡∏ó‡∏°' ‡∏£‡∏±‡∏ö‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏©‡∏≤‡πÉ‡∏î?", a: "‡∏†‡∏≤‡∏©‡∏≤‡πÄ‡∏Ç‡∏°‡∏£", used: false },
                { pts: 200, q: "‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ '‡πÄ‡∏î‡∏¥‡∏ô' ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏ú‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏≤‡∏°‡∏ï‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏Ç‡∏°‡∏£‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£?", a: "‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô", used: false },
                { pts: 300, q: "‡∏û‡∏¢‡∏±‡∏ç‡∏ä‡∏ô‡∏∞‡∏™‡∏∞‡∏Å‡∏î‡∏ï‡∏±‡∏ß '‡∏à' ‡πÉ‡∏ô‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ '‡πÄ‡∏™‡∏î‡πá‡∏à' ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏≠‡∏Å‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏†‡∏≤‡∏©‡∏≤‡πÉ‡∏î?", a: "‡∏†‡∏≤‡∏©‡∏≤‡πÄ‡∏Ç‡∏°‡∏£", used: false },
                { pts: 400, q: "‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ '‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î' ‡πÅ‡∏ú‡∏•‡∏á‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£?", a: "‡πÄ‡∏Å‡∏¥‡∏î", used: false },
                { pts: 500, q: "‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡∏•‡∏á‡∏Ñ‡∏≥ '‡∏ï‡∏£‡∏ß‡∏à' ‡πÄ‡∏õ‡πá‡∏ô '‡∏ï‡∏≥‡∏£‡∏ß‡∏à' ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏≠‡∏∞‡πÑ‡∏£‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏≥?", a: "‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏≠‡∏≤‡∏Ñ‡∏° (‡∏≠‡∏≥-‡∏ô)", used: false }
            ]
        },
        {
            category: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©",
            questions: [
                { pts: 100, q: "‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ 'Bank' ‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô '‡πÅ‡∏ö‡∏á‡∏Å‡πå' ‡πÉ‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£?", a: "‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡∏ö‡∏®‡∏±‡∏û‡∏ó‡πå", used: false },
                { pts: 200, q: "‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ '‡∏ß‡∏µ‡∏î‡∏¥‡∏ó‡∏±‡∏®‡∏ô‡πå' ‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÅ‡∏ó‡∏ô‡∏Ñ‡∏≥‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£?", a: "Video", used: false },
                { pts: 300, q: "‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ '‡πÇ‡∏ä‡πÄ‡∏ü‡∏≠‡∏£‡πå' ‡∏°‡∏µ‡∏£‡∏≤‡∏Å‡∏®‡∏±‡∏û‡∏ó‡πå‡πÄ‡∏î‡∏¥‡∏°‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏©‡∏≤‡πÉ‡∏î?", a: "‡∏†‡∏≤‡∏©‡∏≤‡∏ù‡∏£‡∏±‡πà‡∏á‡πÄ‡∏®‡∏™ (‡∏£‡∏±‡∏ö‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤‡∏ó‡∏≤‡∏á‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©)", used: false },
                { pts: 400, q: "‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ '‡∏ñ‡∏π‡∏Å‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡πâ‡∏á' ‡∏£‡∏±‡∏ö‡∏≠‡∏¥‡∏ó‡∏ò‡∏¥‡∏û‡∏•‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏©‡∏≤‡πÉ‡∏î?", a: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© (Passive Voice)", used: false },
                { pts: 500, q: "‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ö‡∏±‡∏ç‡∏ç‡∏±‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ 'Globalization' ‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£?", a: "‡πÇ‡∏•‡∏Å‡∏≤‡∏†‡∏¥‡∏ß‡∏±‡∏ï‡∏ô‡πå", used: false }
            ]
        },
        {
            category: "‡∏à‡∏µ‡∏ô/‡∏ä‡∏ß‡∏≤/‡∏°‡∏•‡∏≤‡∏¢‡∏π",
            questions: [
                { pts: 100, q: "‡∏Ñ‡∏≥‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏ä‡πâ '‡∏ï‡∏∞‡πÄ‡∏Å‡∏µ‡∏¢‡∏ö' ‡πÅ‡∏•‡∏∞ '‡∏ï‡∏π‡πâ' ‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏©‡∏≤‡πÉ‡∏î?", a: "‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏µ‡∏ô", used: false },
                { pts: 200, q: "‡∏ß‡∏£‡∏£‡∏ì‡∏Ñ‡∏î‡∏µ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á '‡∏≠‡∏¥‡πÄ‡∏´‡∏ô‡∏≤' ‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≥‡∏¢‡∏∑‡∏°‡∏†‡∏≤‡∏©‡∏≤‡πÉ‡∏î?", a: "‡∏†‡∏≤‡∏©‡∏≤‡∏ä‡∏ß‡∏≤", used: false },
                { pts: 300, q: "‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ '‡∏°‡∏±‡∏á‡∏Ñ‡∏∏‡∏î' ‡πÅ‡∏•‡∏∞ '‡∏ó‡∏∏‡πÄ‡∏£‡∏µ‡∏¢‡∏ô' ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡∏¢‡∏∑‡∏°‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏©‡∏≤‡πÉ‡∏î?", a: "‡∏†‡∏≤‡∏©‡∏≤‡∏°‡∏•‡∏≤‡∏¢‡∏π", used: false },
                { pts: 400, q: "‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ '‡∏ö‡∏∏‡∏´‡∏•‡∏±‡∏ô' ‡πÉ‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏ä‡∏ß‡∏≤ ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≥‡πÑ‡∏ó‡∏¢‡∏ß‡πà‡∏≤‡∏≠‡∏∞‡πÑ‡∏£?", a: "‡∏î‡∏ß‡∏á‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå", used: false },
                { pts: 500, q: "‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ '‡πÄ‡∏à‡πä' ‡πÅ‡∏•‡∏∞ '‡πÄ‡∏Æ‡∏µ‡∏¢' ‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏µ‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ß‡∏£‡∏£‡∏ì‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡∏Ñ‡∏π‡πà‡πÉ‡∏î?", a: "‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ï‡∏£‡∏µ ‡πÅ‡∏•‡∏∞ ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏à‡∏±‡∏ï‡∏ß‡∏≤", used: false }
            ]
        }
    ];

    let teams = [{name:"‡∏ó‡∏µ‡∏° 1",score:0},{name:"‡∏ó‡∏µ‡∏° 2",score:0},{name:"‡∏ó‡∏µ‡∏° 3",score:0},{name:"‡∏ó‡∏µ‡∏° 4",score:0}];
    let currentQ = null, timerInterval = null, gameTime = 3600;

    function init() { renderBoard(); renderScoreboard(); startGlobalTimer(); }

    function renderBoard() {
        const board = document.getElementById('game-board');
        board.innerHTML = '';
        gameData.forEach((cat, cIdx) => {
            const col = document.createElement('div');
            col.className = "space-y-4";
            const head = document.createElement('div');
            head.className = "bg-blue-900/40 p-5 rounded-2xl border border-blue-500/50 font-black text-center text-blue-200 uppercase tracking-tighter h-20 flex items-center justify-center shadow-lg";
            head.innerText = cat.category;
            col.appendChild(head);
            cat.questions.forEach((q, qIdx) => {
                const btn = document.createElement('button');
                btn.className = q.used ? "w-full py-8 bg-slate-800/30 text-slate-700 rounded-2xl border border-slate-800 cursor-not-allowed font-bold" : "w-full py-8 bg-slate-800 hover:bg-blue-600 rounded-2xl border border-slate-700 transition-all text-3xl font-black text-yellow-500 hover:text-white shadow-xl hover:-translate-y-1";
                btn.innerText = q.used ? "‚úò" : q.pts;
                if (!q.used) btn.onclick = () => openQuestion(cIdx, qIdx);
                col.appendChild(btn);
            });
            board.appendChild(col);
        });
    }

    function renderScoreboard() {
        const sb = document.getElementById('scoreboard');
        sb.innerHTML = '';
        teams.forEach((t, i) => {
            const div = document.createElement('div');
            div.className = "bg-slate-800/80 backdrop-blur p-5 rounded-3xl border border-slate-700 shadow-2xl flex justify-between items-center transition-all hover:border-blue-500/50";
            div.innerHTML = `<div><p class="text-xs text-slate-400 font-black uppercase tracking-widest">${t.name}</p><p class="text-4xl font-mono font-black text-blue-400">${t.score}</p></div><div class="flex flex-col gap-1"><button onclick="updateScore(${i},50)" class="bg-blue-600/30 text-blue-300 p-1.5 rounded-lg hover:bg-blue-600/50 text-[10px] font-bold">+50</button><button onclick="updateScore(${i},-50)" class="bg-red-900/30 text-red-400 p-1.5 rounded-lg hover:bg-red-900/50 text-[10px] font-bold">-50</button></div>`;
            sb.appendChild(div);
        });
    }

    function startGlobalTimer() {
        const display = document.getElementById('game-timer');
        if (window.gTimer) clearInterval(window.gTimer);
        window.gTimer = setInterval(() => {
            if (gameTime > 0) {
                gameTime--;
                const m = Math.floor(gameTime / 60), s = gameTime % 60;
                display.innerText = `${m}:${s < 10 ? '0'+s : s}`;
                if (gameTime < 300) display.classList.add('text-red-500', 'animate-pulse');
            }
        }, 1000);
    }

    function openQuestion(cIdx, qIdx) {
        sfx.open();
        currentQ = { cIdx, qIdx, ...gameData[cIdx].questions[qIdx] };
        document.getElementById('modal-category').innerText = gameData[cIdx].category;
        document.getElementById('modal-points').innerText = currentQ.pts;
        document.getElementById('modal-question').innerText = currentQ.q;
        document.getElementById('answer-text').innerText = currentQ.a;
        document.getElementById('modal-answer').classList.add('hidden');
        document.getElementById('btn-show-answer').classList.remove('hidden');
        document.getElementById('scoring-controls').classList.add('hidden');
        document.getElementById('modal').classList.remove('hidden');
        startModalTimer();
    }

    function startModalTimer() {
        let timeLeft = 30;
        const bar = document.getElementById('modal-timer');
        bar.style.width = '100%';
        bar.classList.remove('timer-urgent');
        if (timerInterval) clearInterval(timerInterval);
        timerInterval = setInterval(() => {
            timeLeft--;
            bar.style.width = (timeLeft / 30 * 100) + '%';
            if (timeLeft <= 5) { sfx.timer(); bar.classList.add('timer-urgent'); }
            if (timeLeft <= 0) { clearInterval(timerInterval); sfx.wrong(); }
        }, 1000);
    }

    function showAnswer() {
        sfx.click(); clearInterval(timerInterval);
        document.getElementById('modal-answer').classList.remove('hidden');
        document.getElementById('btn-show-answer').classList.add('hidden');
        const sc = document.getElementById('scoring-controls');
        sc.innerHTML = '';
        teams.forEach((t, i) => {
            const b = document.createElement('button');
            b.className = "bg-emerald-600 hover:bg-emerald-500 px-6 py-3 rounded-xl font-black text-sm transition shadow-lg active:scale-95";
            b.innerText = t.name + " +";
            b.onclick = () => awardPoints(i);
            sc.appendChild(b);
        });
        sc.classList.remove('hidden');
    }

    function awardPoints(tIdx) {
        sfx.correct();
        teams[tIdx].score += currentQ.pts;
        gameData[currentQ.cIdx].questions[currentQ.qIdx].used = true;
        closeModal();
    }

    function updateScore(tIdx, amt) { teams[tIdx].score += amt; sfx.click(); renderScoreboard(); }
    function closeModal() { clearInterval(timerInterval); document.getElementById('modal').classList.add('hidden'); renderBoard(); renderScoreboard(); currentQ = null; }
    function setupTeams() { const names = prompt("‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏à‡∏∏‡∏•‡∏†‡∏≤‡∏Ñ (,) ‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏±‡∏á‡∏Å‡∏£,‡∏™‡∏¥‡∏á‡∏´‡πå,‡∏´‡∏á‡∏™‡πå,‡πÄ‡∏ï‡πà‡∏≤", teams.map(t=>t.name).join(',')); if (names) { teams = names.split(',').map(n => ({ name: n.trim(), score: 0 })); renderScoreboard(); } }
    function resetGame() { if (confirm("‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?")) { gameData.forEach(c => c.questions.forEach(q => q.used = false)); teams.forEach(t => t.score = 0); gameTime = 3600; init(); sfx.win(); } }

    window.onload = init;
</script>
</body>
</html>
